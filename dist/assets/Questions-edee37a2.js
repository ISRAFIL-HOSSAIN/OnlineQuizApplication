import{j as e,r as i,M as q,i as A,F as B,k as x,at as I,L as b,D as z,E as L,C as E,t as T}from"./index-f5628c54.js";import{P as $,B as M,T as g}from"./PackageBreadcrumb-0dbe9830.js";import{Q as W}from"./QuestionService-e69394ba.js";import{P as D}from"./Progress-3b628373.js";import{N as O}from"./NotFound-6ab4e900.js";import{C as V,F as G,R as H,a as U,b as Y}from"./RadioGroup-88f68257.js";const J={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",width:"350px",bgcolor:"background.paper",border:"2px solid #F7FDFF",borderRadius:"10px",boxShadow:"3px 2px 3px 1px rgba(0, 0, 0, 0.2)",p:4,maxHeight:"90vh",overflow:"auto"},K=({open:c,onClose:o,id:l})=>{const f=()=>{o()};return e.jsx(i.Fragment,{children:e.jsx(q,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:c,onClose:!1,closeAfterTransition:!0,slots:{backdrop:A},slotProps:{backdrop:{timeout:500}},children:e.jsx(B,{in:c,children:e.jsxs(x,{sx:J,children:[e.jsx(x,{sx:{pb:0,float:"right",width:"50px"}}),e.jsx("div",{className:" mt-10 flex justify-center text-center",children:e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx(I,{className:"w-14 h-14 my-3 text-emerald-500 "}),e.jsx("h3",{className:"text-2xl font-medium font-sans text-emerald-800 my-3",children:"Your Response is Submited Successfully !"}),e.jsx(b,{to:`/results/viewresults/${l}`,children:e.jsx("button",{className:`bg-gradient-to-r from-green-300 via-emerald-500 to-emerald-600 hover:from-emerald-600\r
                hover:via-emerald-400 hover:to-green-300 \r
                font-semibold  border px-8 py-2  text-white rounded-full mt-8`,type:"submit",onClick:()=>f(),children:"View Result"})})]})})]})})})})},ne=()=>{const c=z(),o=new URLSearchParams(c.search).get("id"),[l,f]=i.useState([]),[m,v]=i.useState([]),[y,w]=i.useState(""),[_,h]=i.useState(!1),[N,p]=i.useState(!1),[S,j]=i.useState(!1),C=localStorage.getItem("userid"),F=localStorage.getItem("username");function Q(s){for(let t=s.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[s[t],s[r]]=[s[r],s[t]]}return s}const P=()=>j(!1),k=(s,t)=>{v(r=>{const a=r.findIndex(n=>n.question_id===s);if(a!==-1){const n=[...r];return n[a].selected_value=t,n}else{if(!l.find(u=>u._id===s))return r;const d={question_id:s,selected_value:t};return[...r,d]}})},R=async()=>{var s,t;try{h(!0);const r={userId:C,username:F,items:m,quizName:o};if(l.every(n=>m.some(d=>d.question_id===n._id&&d.selected_value!==""))){const n=await W.addResult(r);n.status===200?(w((t=(s=n==null?void 0:n.data)==null?void 0:s.resultdata)==null?void 0:t._id),j(!0),h(!1)):console.log("Something went wrong")}else{alert("Please make sure fill-up every question answer, otherwise you can't Submit"),h(!1);return}}catch(r){console.log("Error",r)}};return i.useEffect(()=>{(async()=>{p(!0);try{const t=await T.get(`/questions/questionbyquiz?quiz=${o}`),r=Q([...t.data]);f(r),p(!1)}catch(t){console.error("Error fetching questions:",t),p(!1)}})()},[o]),e.jsx(i.Fragment,{children:e.jsxs("div",{children:[e.jsx($,{children:e.jsxs(M,{"aria-label":"breadcrumb",children:[e.jsx(b,{underline:"hover",color:"grey",to:"/allquiz",children:e.jsxs(x,{sx:{justifyContent:"center",display:"flex",color:"green",fontSize:"16px",fontWeight:"600"},children:[e.jsx(L,{size:23,className:"min-w-max text-emerald-500"}),"  Question"]})}),e.jsx(g,{color:"grey",children:o}),e.jsxs(g,{children:["Total Questions : ",l.length]})]})}),N?e.jsx(E,{}):e.jsx("div",{children:l&&l.length>1?e.jsxs("div",{className:"mx-1",children:[l.map((s,t)=>{var r;return e.jsxs(V,{sx:{maxWidth:"100%",margin:"auto",marginTop:5,"@media screen and (min-width: 768px)":{maxWidth:"80%"},padding:"12px"},children:[e.jsxs("div",{className:"text-[16px] font-sans font-medium  text-start py-5 lg:px-5 flex",children:[e.jsx("span",{className:"p-4 flex items-center justify-center rounded-full bg-emerald-600 text-white  mx-2 my-2 w-5 h-5 ",children:t+1}),e.jsx("span",{className:"pt-2",children:s.question_name})]}),s.image?e.jsx("div",{className:"flex justify-center w-full h-48",children:e.jsx("img",{src:s.image,alt:""})}):"",e.jsx("div",{className:"w-full py-5 justify-center items-center flex",children:e.jsx(G,{component:"fieldset",children:e.jsx(H,{className:"flex justify-center items-center","aria-label":`question_${s._id}`,name:`question_${s._id}`,value:((r=m.find(a=>a.question_id===s._id))==null?void 0:r.selected_value)||"",onChange:a=>k(s._id,a.target.value),children:e.jsx("div",{className:" justify-center lg:ml-8 items-center flex flex-wrap w-full gap-5 p-2",children:Object.entries(s.options[0]).filter(([a])=>a.startsWith("option_")).map(([a,n],d)=>e.jsx("div",{className:`border-2 border-green-200 w-72 px-5 rounded-md mx-5 ${m.find(u=>u.question_id===s._id&&u.selected_value===a)?"bg-green-50":""}`,children:e.jsx(U,{value:a,control:e.jsx(Y,{sx:{color:"#6c63ff"}}),label:e.jsx(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",textAlign:"start"},children:e.jsx(g,{sx:{fontSize:14,paddingTop:1,paddingBottom:1},children:n})})})},d))})})})})]},s._id)}),e.jsx("div",{className:"justify-center items-center flex mt-5",children:e.jsx("button",{className:`bg-gradient-to-r from-green-300 via-emerald-500 to-emerald-600 hover:from-emerald-600\r
              hover:via-emerald-400 hover:to-green-300 \r
                font-semibold  border px-12 py-2  text-white rounded-full flex `,type:"submit",onClick:R,children:_?e.jsxs(e.Fragment,{children:[e.jsx(D,{})," "," "]}):"Submit"})}),e.jsx(K,{open:S,onClose:P,id:y})]}):e.jsx("div",{children:e.jsx(O,{})})})]})})};export{ne as default};
